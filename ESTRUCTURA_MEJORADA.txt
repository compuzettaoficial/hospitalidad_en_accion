
üèóÔ∏è Estructura de Archivos Actualizada
/
‚îú‚îÄ‚îÄ index.html                     ‚Üí P√°gina principal (grilla eventos)
‚îú‚îÄ‚îÄ welcome.html                   ‚Üí Presentaci√≥n inicial
‚îú‚îÄ‚îÄ event-detail.html             ‚Üí Detalle de evento
‚îú‚îÄ‚îÄ profile.html                   ‚Üí Mi Perfil
‚îú‚îÄ‚îÄ auth/
‚îÇ   ‚îú‚îÄ‚îÄ login.html                 ‚Üí Login
‚îÇ   ‚îú‚îÄ‚îÄ register.html              ‚Üí Registro de usuario
‚îÇ   ‚îî‚îÄ‚îÄ forgot-password.html       ‚Üí Recuperar contrase√±a
‚îú‚îÄ‚îÄ admin/
‚îÇ   ‚îú‚îÄ‚îÄ dashboard.html             ‚Üí Panel administrador
‚îÇ   ‚îú‚îÄ‚îÄ events-management.html     ‚Üí Gesti√≥n de eventos
‚îÇ   ‚îú‚îÄ‚îÄ users-management.html      ‚Üí Gesti√≥n de usuarios
‚îÇ   ‚îú‚îÄ‚îÄ editors-assignment.html    ‚Üí Asignaci√≥n editores a eventos
‚îÇ   ‚îú‚îÄ‚îÄ matching-system.html       ‚Üí Sistema de emparejamiento
‚îÇ   ‚îú‚îÄ‚îÄ ratings-management.html    ‚Üí Gesti√≥n de valoraciones
‚îÇ   ‚îî‚îÄ‚îÄ reports.html               ‚Üí Reportes y estad√≠sticas
‚îú‚îÄ‚îÄ editor/
‚îÇ   ‚îú‚îÄ‚îÄ dashboard.html             ‚Üí Panel editor (eventos asignados)
‚îÇ   ‚îú‚îÄ‚îÄ my-events.html             ‚Üí Mis eventos asignados
‚îÇ   ‚îú‚îÄ‚îÄ matching-assigned.html     ‚Üí Emparejamiento eventos asignados
‚îÇ   ‚îî‚îÄ‚îÄ reports-assigned.html      ‚Üí Reportes de eventos asignados
‚îú‚îÄ‚îÄ event/
‚îÇ   ‚îú‚îÄ‚îÄ create-event.html          ‚Üí Crear evento (admin)
‚îÇ   ‚îú‚îÄ‚îÄ edit-event.html            ‚Üí Editar evento (admin/editor asignado)
‚îÇ   ‚îú‚îÄ‚îÄ hotels-management.html     ‚Üí Gesti√≥n hoteles/cocheras
‚îÇ   ‚îú‚îÄ‚îÄ participants.html          ‚Üí Gesti√≥n participantes
‚îÇ   ‚îî‚îÄ‚îÄ accommodation-info.html    ‚Üí Info de alojamientos para asistentes
‚îú‚îÄ‚îÄ forms/
‚îÇ   ‚îú‚îÄ‚îÄ host-registration.html     ‚Üí Registro anfitri√≥n
‚îÇ   ‚îú‚îÄ‚îÄ visitor-application.html   ‚Üí Postulaci√≥n visitante
‚îÇ   ‚îú‚îÄ‚îÄ attendee-registration.html ‚Üí Registro asistente
‚îÇ   ‚îî‚îÄ‚îÄ application-review.html    ‚Üí Revisi√≥n de postulaciones
‚îú‚îÄ‚îÄ ratings/
‚îÇ   ‚îú‚îÄ‚îÄ rate-host.html             ‚Üí Valorar anfitri√≥n
‚îÇ   ‚îú‚îÄ‚îÄ rate-visitor.html          ‚Üí Valorar visitante
‚îÇ   ‚îî‚îÄ‚îÄ ratings-display.html       ‚Üí Mostrar valoraciones
‚îú‚îÄ‚îÄ css/
‚îÇ   ‚îú‚îÄ‚îÄ main.css                   ‚Üí Estilos principales
‚îÇ   ‚îú‚îÄ‚îÄ admin.css                  ‚Üí Estilos panel admin
‚îÇ   ‚îú‚îÄ‚îÄ editor.css                 ‚Üí Estilos panel editor
‚îÇ   ‚îú‚îÄ‚îÄ forms.css                  ‚Üí Estilos formularios
‚îÇ   ‚îú‚îÄ‚îÄ ratings.css                ‚Üí Estilos sistema valoraci√≥n
‚îÇ   ‚îî‚îÄ‚îÄ components.css             ‚Üí Estilos componentes
‚îú‚îÄ‚îÄ js/
‚îÇ   ‚îú‚îÄ‚îÄ main.js                    ‚Üí L√≥gica principal
‚îÇ   ‚îú‚îÄ‚îÄ firebase-config.js         ‚Üí Configuraci√≥n Firebase
‚îÇ   ‚îú‚îÄ‚îÄ auth.js                    ‚Üí Autenticaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ events.js                  ‚Üí Gesti√≥n eventos
‚îÇ   ‚îú‚îÄ‚îÄ users.js                   ‚Üí Gesti√≥n usuarios
‚îÇ   ‚îú‚îÄ‚îÄ permissions.js             ‚Üí Control de permisos por evento
‚îÇ   ‚îú‚îÄ‚îÄ matching.js                ‚Üí Sistema emparejamiento
‚îÇ   ‚îú‚îÄ‚îÄ ratings.js                 ‚Üí Sistema valoraciones
‚îÇ   ‚îú‚îÄ‚îÄ notifications.js           ‚Üí Notificaciones
‚îÇ   ‚îî‚îÄ‚îÄ utils.js                   ‚Üí Funciones utilitarias
‚îú‚îÄ‚îÄ img/
‚îÇ   ‚îú‚îÄ‚îÄ logos/
‚îÇ   ‚îú‚îÄ‚îÄ banners/
‚îÇ   ‚îú‚îÄ‚îÄ events/
‚îÇ   ‚îú‚îÄ‚îÄ hotels/
‚îÇ   ‚îî‚îÄ‚îÄ icons/
‚îî‚îÄ‚îÄ components/
    ‚îú‚îÄ‚îÄ header.html
    ‚îú‚îÄ‚îÄ footer.html
    ‚îú‚îÄ‚îÄ event-card.html
    ‚îú‚îÄ‚îÄ star-rating.html
    ‚îî‚îÄ‚îÄ navigation.html
üéØ Sistema de Roles y Permisos Actualizado
Roles del Sistema:
üîë ADMINISTRADOR (compuzettaoficial@gmail.com)

Acceso total a todos los eventos
Asignar editores a eventos espec√≠ficos
Crear/eliminar eventos en cualquier ciudad
Gestionar usuarios y cambiar roles
Acceso completo al sistema de emparejamiento
Ver reportes globales de toda la plataforma

‚úèÔ∏è EDITOR

Acceso limitado solo a eventos asignados por el admin
No puede crear eventos nuevos
Editar informaci√≥n solo de sus eventos asignados
Gestionar hoteles/cocheras solo de sus eventos
Emparejamiento solo en sus eventos asignados
Ver reportes solo de sus eventos

üë§ USUARIO

Acceso b√°sico a funcionalidades
Participar en cualquier evento
Ver informaci√≥n de todos los eventos

üìä Estructura de Base de Datos Actualizada
Colecciones Principales:
javascript// usuarios (actualizada con asignaciones)
{
  uid: "user_id",
  nombre: "string",
  apellido: "string",
  email: "string",
  rol: "administrador|editor|usuario",
  telefono: "string",
  estado: "activo|inactivo",
  rating_promedio: "number",
  total_valoraciones: "number",
  // NUEVA FUNCIONALIDAD PARA EDITORES
  eventos_asignados: ["evento_id1", "evento_id2"], // Solo para editores
  asignado_por: "admin_user_id", // Quien asign√≥ los eventos
  fecha_asignacion: "timestamp",
  createdAt: "timestamp"
}

// eventos (actualizada con informaci√≥n de editores)
{
  id: "evento_id",
  titulo: "string",
  descripcion: "string",
  lugar: "string",
  ciudad: "string", // NUEVO: Para filtrar por ubicaci√≥n
  fecha_inicio: "timestamp",
  fecha_fin: "timestamp",
  imagenURL: "string",
  estado: "activo|inactivo",
  creado_por: "user_id",
  // NUEVA FUNCIONALIDAD
  editores_asignados: ["editor_id1", "editor_id2"], // Editores que pueden gestionar este evento
  region: "string", // Para agrupar eventos por regi√≥n
  estadisticas: {
    anfitriones: "number",
    visitantes: "number",
    asistentes: "number",
    emparejamientos: "number"
  },
  hoteles: [...],
  cocheras: [...]
}

// asignaciones_editores (nueva colecci√≥n)
{
  id: "asignacion_id",
  admin_id: "admin_user_id",
  editor_id: "editor_user_id",
  evento_id: "event_id",
  fecha_asignacion: "timestamp",
  estado: "activa|revocada",
  permisos: {
    gestionar_anfitriones: "boolean",
    gestionar_visitantes: "boolean",
    gestionar_hoteles: "boolean",
    crear_emparejamientos: "boolean",
    ver_reportes: "boolean"
  },
  notas: "string" // Notas del admin sobre la asignaci√≥n
}

// logs_permisos (nueva colecci√≥n para auditor√≠a)
{
  id: "log_id",
  usuario_id: "user_id",
  evento_id: "event_id",
  accion: "string", // "acceso_denegado", "accion_realizada", etc.
  detalle: "string",
  ip_address: "string",
  timestamp: "timestamp"
}
üîê Sistema de Control de Permisos
Funci√≥n de Verificaci√≥n de Permisos:
javascript// Verificar si un editor puede acceder a un evento espec√≠fico
function verificarPermisoEditor(editorId, eventoId) {
  return db.collection('asignaciones_editores')
    .where('editor_id', '==', editorId)
    .where('evento_id', '==', eventoId)
    .where('estado', '==', 'activa')
    .get()
    .then(querySnapshot => !querySnapshot.empty);
}

// Verificar permisos espec√≠ficos dentro de un evento
function verificarPermisoEspecifico(editorId, eventoId, tipoPermiso) {
  return db.collection('asignaciones_editores')
    .where('editor_id', '==', editorId)
    .where('evento_id', '==', eventoId)
    .where('estado', '==', 'activa')
    .get()
    .then(querySnapshot => {
      if (querySnapshot.empty) return false;
      const permisos = querySnapshot.docs[0].data().permisos;
      return permisos[tipoPermiso] === true;
    });
}
üéõÔ∏è Panel de Asignaci√≥n de Editores (Solo Admin)
Funcionalidades del Panel:
1. Asignar Editor a Evento
html<!-- Formulario de asignaci√≥n -->
<div class="assignment-form">
  <h3>Asignar Editor a Evento</h3>
  <select id="editorSelect">
    <option value="">Seleccionar Editor</option>
    <!-- Cargar editores disponibles -->
  </select>
  <select id="eventoSelect">
    <option value="">Seleccionar Evento</option>
    <!-- Cargar eventos disponibles -->
  </select>
  <div class="permissions-checkboxes">
    <label><input type="checkbox" name="gestionar_anfitriones"> Gestionar Anfitriones</label>
    <label><input type="checkbox" name="gestionar_visitantes"> Gestionar Visitantes</label>
    <label><input type="checkbox" name="gestionar_hoteles"> Gestionar Hoteles</label>
    <label><input type="checkbox" name="crear_emparejamientos"> Crear Emparejamientos</label>
    <label><input type="checkbox" name="ver_reportes"> Ver Reportes</label>
  </div>
  <button onclick="asignarEditor()">Asignar</button>
</div>
2. Ver Asignaciones Activas
html<!-- Tabla de asignaciones -->
<div class="assignments-table">
  <h3>Asignaciones Activas</h3>
  <table>
    <thead>
      <tr>
        <th>Editor</th>
        <th>Evento</th>
        <th>Ciudad</th>
        <th>Fecha Asignaci√≥n</th>
        <th>Permisos</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody id="assignmentsTableBody">
      <!-- Cargar asignaciones din√°micamente -->
    </tbody>
  </table>
</div>
3. Revocar Asignaciones
html<!-- Bot√≥n para revocar con confirmaci√≥n -->
<button onclick="revocarAsignacion(asignacionId)" class="btn-danger">
  Revocar Acceso
</button>
üîÑ Flujos de Trabajo Actualizados
1. Flujo de Asignaci√≥n de Editor:
Admin ‚Üí Panel Asignaciones ‚Üí Seleccionar Editor ‚Üí Seleccionar Evento(s)
‚Üí Configurar Permisos ‚Üí Asignar ‚Üí Notificar al Editor
2. Flujo de Acceso del Editor:
Editor Login ‚Üí Verificar Eventos Asignados ‚Üí Acceder Solo a Sus Eventos
‚Üí Intentar Acci√≥n ‚Üí Verificar Permisos ‚Üí Permitir/Denegar ‚Üí Log de Auditor√≠a
3. Flujo de Revocaci√≥n:
Admin ‚Üí Ver Asignaciones ‚Üí Seleccionar Asignaci√≥n ‚Üí Revocar
‚Üí Actualizar Permisos ‚Üí Notificar al Editor ‚Üí Log de Cambios
üõ°Ô∏è Medidas de Seguridad
1. Middleware de Permisos
javascript// Middleware para verificar permisos antes de cada acci√≥n
function checkEventPermission(req, res, next) {
  const userId = req.user.uid;
  const eventoId = req.params.eventoId;
  
  if (req.user.rol === 'administrador') {
    next(); // Admin tiene acceso total
  } else if (req.user.rol === 'editor') {
    verificarPermisoEditor(userId, eventoId)
      .then(hasPermission => {
        if (hasPermission) {
          next();
        } else {
          res.status(403).json({ error: 'Acceso denegado a este evento' });
        }
      });
  } else {
    res.status(403).json({ error: 'Rol insuficiente' });
  }
}
2. Reglas de Firestore
javascript// Reglas para limitar acceso de editores
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Solo admin puede crear eventos
    match /eventos/{eventoId} {
      allow create: if request.auth != null && 
        get(/databases/$(database)/documents/usuarios/$(request.auth.uid)).data.rol == 'administrador';
      
      // Editor solo puede editar eventos asignados
      allow update: if request.auth != null && (
        get(/databases/$(database)/documents/usuarios/$(request.auth.uid)).data.rol == 'administrador' ||
        (get(/databases/$(database)/documents/usuarios/$(request.auth.uid)).data.rol == 'editor' &&
         eventoId in get(/databases/$(database)/documents/usuarios/$(request.auth.uid)).data.eventos_asignados)
      );
    }
  }
}
3. Logging y Auditor√≠a
javascript// Registrar todas las acciones de editores
function logAction(userId, eventoId, accion, detalle) {
  db.collection('logs_permisos').add({
    usuario_id: userId,
    evento_id: eventoId,
    accion: accion,
    detalle: detalle,
    ip_address: getClientIP(),
    timestamp: firebase.firestore.FieldValue.serverTimestamp()
  });
}
üé® Interfaz de Usuario Mejorada
Dashboard del Editor:
html<!-- Solo muestra eventos asignados -->
<div class="editor-dashboard">
  <h2>Mis Eventos Asignados</h2>
  <div class="assigned-events-grid">
    <!-- Solo eventos donde el editor tiene permisos -->
  </div>
  
  <div class="permissions-summary">
    <h3>Mis Permisos</h3>
    <ul>
      <li>‚úÖ Gestionar Anfitriones</li>
      <li>‚úÖ Gestionar Visitantes</li>
      <li>‚ùå Gestionar Hoteles</li>
      <li>‚úÖ Crear Emparejamientos</li>
      <li>‚úÖ Ver Reportes</li>
    </ul>
  </div>
</div>
Notificaciones de Permisos:
html<!-- Alertas cuando no tiene permisos -->
<div class="permission-alert">
  <p>‚ö†Ô∏è No tienes permisos para acceder a este evento</p>
  <p>Contacta al administrador si necesitas acceso</p>
</div>
