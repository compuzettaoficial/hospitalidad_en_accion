# ğŸ  ESTRUCTURA COMPLETA - WEBAPP HOSPITALIDAD CRISTIANA

## ğŸ¯ PROPÃ“SITO Y VALORES FUNDAMENTALES

**MisiÃ³n**: Webapp que conecta cristianos para ofrecer hospitalidad gratuita durante eventos religiosos. Los hermanos sin recursos pueden encontrar hospedaje gratuito en casas de otros cristianos.

**Valores Cristianos Fundamentales**:
- â­ **LA VALORACIÃ“N ES POR COMPORTAMIENTO CRISTIANO, NO POR LUJOS**
- ğŸ  Pueden participar personas humildes con casas humildes
- â¤ï¸ El trato y semejanza al carÃ¡cter de Cristo es lo que se valora
- ğŸ†“ Servicio completamente gratuito
- ğŸ¤ Fomentar la hospitalidad bÃ­blica entre hermanos

---

## ğŸ—ï¸ ESTRUCTURA DE ARCHIVOS ACTUALIZADA

```
/
â”œâ”€â”€ index.html                     â†’ PÃ¡gina principal (grilla eventos)
â”œâ”€â”€ welcome.html                   â†’ PresentaciÃ³n inicial
â”œâ”€â”€ event-detail.html             â†’ Detalle de evento
â”œâ”€â”€ profile.html                   â†’ Mi Perfil (centro de notificaciones)
â”œâ”€â”€ auth/
â”‚   â”œâ”€â”€ login.html                 â†’ Login
â”‚   â”œâ”€â”€ register.html              â†’ Registro de usuario
â”‚   â””â”€â”€ forgot-password.html       â†’ Recuperar contraseÃ±a
â”œâ”€â”€ admin/
â”‚   â”œâ”€â”€ dashboard.html             â†’ Panel administrador
â”‚   â”œâ”€â”€ events-management.html     â†’ GestiÃ³n de eventos
â”‚   â”œâ”€â”€ users-management.html      â†’ GestiÃ³n de usuarios
â”‚   â”œâ”€â”€ editors-assignment.html    â†’ AsignaciÃ³n editores a eventos
â”‚   â”œâ”€â”€ verification-center.html   â†’ Centro de verificaciÃ³n manual
â”‚   â”œâ”€â”€ matching-manual.html       â†’ Sistema de emparejamiento manual
â”‚   â”œâ”€â”€ ratings-management.html    â†’ GestiÃ³n de valoraciones
â”‚   â”œâ”€â”€ event-observations.html    â†’ Observaciones por evento
â”‚   â”œâ”€â”€ backup-management.html     â†’ GestiÃ³n de contingencias
â”‚   â””â”€â”€ reports.html               â†’ Reportes y estadÃ­sticas
â”œâ”€â”€ editor/
â”‚   â”œâ”€â”€ dashboard.html             â†’ Panel editor (eventos asignados)
â”‚   â”œâ”€â”€ my-events.html             â†’ Mis eventos asignados
â”‚   â”œâ”€â”€ verification-assigned.html â†’ VerificaciÃ³n eventos asignados
â”‚   â”œâ”€â”€ matching-assigned.html     â†’ Emparejamiento eventos asignados
â”‚   â”œâ”€â”€ observations-assigned.html â†’ Observaciones eventos asignados
â”‚   â””â”€â”€ reports-assigned.html      â†’ Reportes de eventos asignados
â”œâ”€â”€ event/
â”‚   â”œâ”€â”€ create-event.html          â†’ Crear evento (admin)
â”‚   â”œâ”€â”€ edit-event.html            â†’ Editar evento (admin/editor asignado)
â”‚   â”œâ”€â”€ hotels-management.html     â†’ GestiÃ³n hoteles/cocheras
â”‚   â”œâ”€â”€ participants.html          â†’ GestiÃ³n participantes
â”‚   â”œâ”€â”€ accommodation-info.html    â†’ Info de alojamientos para asistentes
â”‚   â””â”€â”€ contingency-plan.html      â†’ Plan de contingencia
â”œâ”€â”€ forms/
â”‚   â”œâ”€â”€ host-registration.html     â†’ Registro anfitriÃ³n
â”‚   â”œâ”€â”€ visitor-application.html   â†’ PostulaciÃ³n visitante
â”‚   â”œâ”€â”€ attendee-registration.html â†’ Registro asistente
â”‚   â”œâ”€â”€ verification-form.html     â†’ Formulario verificaciÃ³n
â”‚   â””â”€â”€ application-review.html    â†’ RevisiÃ³n de postulaciones
â”œâ”€â”€ ratings/
â”‚   â”œâ”€â”€ rate-host.html             â†’ Valorar anfitriÃ³n (comportamiento cristiano)
â”‚   â”œâ”€â”€ rate-visitor.html          â†’ Valorar visitante (comportamiento cristiano)
â”‚   â”œâ”€â”€ ratings-display.html       â†’ Mostrar valoraciones
â”‚   â””â”€â”€ christian-criteria.html    â†’ Criterios de valoraciÃ³n cristiana
â”œâ”€â”€ verification/
â”‚   â”œâ”€â”€ pending-verification.html  â†’ Verificaciones pendientes
â”‚   â”œâ”€â”€ verification-process.html  â†’ Proceso de verificaciÃ³n
â”‚   â””â”€â”€ verification-history.html  â†’ Historial de verificaciones
â”œâ”€â”€ notifications/
â”‚   â”œâ”€â”€ profile-notifications.html â†’ Notificaciones en perfil
â”‚   â””â”€â”€ status-updates.html        â†’ Actualizaciones de estado
â”œâ”€â”€ css/
â”‚   â”œâ”€â”€ main.css                   â†’ Estilos principales
â”‚   â”œâ”€â”€ admin.css                  â†’ Estilos panel admin
â”‚   â”œâ”€â”€ editor.css                 â†’ Estilos panel editor
â”‚   â”œâ”€â”€ forms.css                  â†’ Estilos formularios
â”‚   â”œâ”€â”€ ratings.css                â†’ Estilos sistema valoraciÃ³n
â”‚   â”œâ”€â”€ verification.css           â†’ Estilos verificaciÃ³n
â”‚   â”œâ”€â”€ notifications.css          â†’ Estilos notificaciones
â”‚   â””â”€â”€ components.css             â†’ Estilos componentes
â”œâ”€â”€ js/
â”‚   â”œâ”€â”€ main.js                    â†’ LÃ³gica principal
â”‚   â”œâ”€â”€ firebase-config.js         â†’ ConfiguraciÃ³n Firebase + Notificaciones internas
â”‚   â”œâ”€â”€ auth.js                    â†’ AutenticaciÃ³n
â”‚   â”œâ”€â”€ events.js                  â†’ GestiÃ³n eventos + PenalizaciÃ³n cancelaciÃ³n
â”‚   â”œâ”€â”€ users.js                   â†’ GestiÃ³n usuarios
â”‚   â”œâ”€â”€ permissions.js             â†’ Control de permisos por evento
â”‚   â”œâ”€â”€ verification.js            â†’ Sistema verificaciÃ³n manual
â”‚   â”œâ”€â”€ matching-manual.js         â†’ Sistema emparejamiento manual
â”‚   â”œâ”€â”€ ratings-christian.js       â†’ Sistema valoraciones cristianas
â”‚   â”œâ”€â”€ notifications.js           â†’ Sistema notificaciones internas + Recordatorios
â”‚   â”œâ”€â”€ backup-system.js           â†’ Sistema de contingencia
â”‚   â”œâ”€â”€ observations.js            â†’ Sistema de observaciones
â”‚   â””â”€â”€ utils.js                   â†’ Funciones utilitarias
â”œâ”€â”€ img/
â”‚   â”œâ”€â”€ logos/
â”‚   â”œâ”€â”€ banners/
â”‚   â”œâ”€â”€ events/
â”‚   â”œâ”€â”€ hotels/
â”‚   â”œâ”€â”€ christian-values/
â”‚   â””â”€â”€ icons/
â””â”€â”€ components/
    â”œâ”€â”€ header.html
    â”œâ”€â”€ footer.html
    â”œâ”€â”€ event-card.html
    â”œâ”€â”€ star-rating-christian.html
    â”œâ”€â”€ verification-badge.html
    â”œâ”€â”€ notification-center.html
    â””â”€â”€ navigation.html
```

---

## ğŸ­ SISTEMA DE ROLES Y PERMISOS ACTUALIZADO

### ğŸ”‘ ADMINISTRADOR (compuzettaoficial@gmail.com)
- âœ… Acceso total a todos los eventos
- âœ… Asignar editores a eventos especÃ­ficos
- âœ… Crear/eliminar eventos en cualquier ciudad
- âœ… Gestionar usuarios y cambiar roles
- âœ… **Sistema de verificaciÃ³n manual completo**
- âœ… **Sistema de emparejamiento manual**
- âœ… **GestiÃ³n de observaciones por evento**
- âœ… **Sistema de backup y contingencias**
- âœ… **Sistema de recordatorios automÃ¡ticos**
- âœ… **Aplicar penalizaciones por cancelaciÃ³n**
- âœ… Acceso completo al sistema de valoraciones cristianas
- âœ… Ver reportes globales de toda la plataforma

### âœï¸ EDITOR
- âœ… Acceso limitado solo a eventos asignados por el admin
- âœ… VerificaciÃ³n manual solo de sus eventos asignados
- âœ… Emparejamiento manual solo en sus eventos asignados
- âœ… Editar informaciÃ³n solo de sus eventos asignados
- âœ… Gestionar hoteles/cocheras solo de sus eventos
- âœ… **Ver recordatorios de verificaciÃ³n de sus eventos**
- âœ… **Aplicar penalizaciones solo en sus eventos asignados**
- âœ… Crear observaciones solo de sus eventos asignados
- âœ… Ver reportes solo de sus eventos
- âŒ No puede crear eventos nuevos
- âŒ No puede acceder a eventos no asignados

### ğŸ‘¤ USUARIO
- âœ… Acceso bÃ¡sico a funcionalidades
- âœ… Participar en cualquier evento
- âœ… Ver informaciÃ³n de todos los eventos
- âœ… **Centro de notificaciones en Mi Perfil**
- âœ… **Recibir recordatorios de verificaciÃ³n**
- âœ… **Sistema de valoraciÃ³n bidireccional**
- âœ… **Proceso de verificaciÃ³n personal**
- âœ… **Recibir penalizaciones por cancelaciÃ³n tardÃ­a**

---

## ğŸ“Š ESTRUCTURA DE BASE DE DATOS ACTUALIZADA

### ğŸ—‚ï¸ ColecciÃ³n: usuarios (ACTUALIZADA CON RECORDATORIOS Y PENALIZACIONES)
```javascript
{
  uid: "user_id",
  nombre: "string",
  apellido: "string",
  email: "string",
  rol: "administrador|editor|usuario",
  telefono: "string",
  estado: "activo|inactivo",
  
  // SISTEMA DE VERIFICACIÃ“N MANUAL
  verificacion: {
    estado: "pendiente_verificacion|verificado|rechazado",
    fecha_solicitud: "timestamp",
    fecha_verificacion: "timestamp",
    verificado_por: "admin_user_id",
    notas_verificador: "string",
    metodo_verificacion: "whatsapp|llamada|presencial",
    contacto_verificacion: "string",
    documentos_verificados: ["cedula", "referencias", "etc"]
  },
  
  // SISTEMA DE RECORDATORIOS AUTOMÃTICOS
  recordatorios_verificacion: {
    ultimo_recordatorio: "timestamp",
    intentos_contacto: "number",
    siguiente_recordatorio: "timestamp",
    frecuencia_recordatorios: "24h|48h|72h",
    notificaciones_enviadas: "number"
  },
  
  // SISTEMA DE VALORACIÃ“N CRISTIANA CON PENALIZACIONES
  valoracion: {
    base_registro: 1, // +1 estrella por registrarse
    base_verificacion: 1, // +1 estrella por verificaciÃ³n
    valoraciones_recibidas: [{
      evento_id: "string",
      valorador_id: "string",
      puntos: "number (1-5)",
      comentario: "string",
      criterios_cristianos: {
        amabilidad: "number (1-5)",
        hospitalidad: "number (1-5)", 
        respeto: "number (1-5)",
        caracter_cristiano: "number (1-5)",
        servicio_desinteresado: "number (1-5)"
      },
      fecha_valoracion: "timestamp"
    }],
    // NUEVO: SISTEMA DE PENALIZACIONES
    penalizaciones: [{
      tipo: "cancelacion_ultimo_momento|no_presentacion|comportamiento_inadecuado",
      evento_id: "string",
      puntos_restados: "number (-1 a -5)",
      fecha: "timestamp",
      motivo: "string",
      aplicado_por: "admin_user_id",
      apelacion: {
        presentada: "boolean",
        fecha_apelacion: "timestamp",
        motivo_apelacion: "string",
        resuelta: "boolean",
        decision_final: "string"
      }
    }],
    promedio_total: "number",
    total_valoraciones: "number",
    total_penalizaciones: "number"
  },
  
  // NOTIFICACIONES INTERNAS MEJORADAS
  notificaciones_internas: {
    verificacion_estado: "pendiente|completada|rechazada",
    recordatorios_pendientes: "number",
    ultimo_recordatorio_enviado: "timestamp",
    postulaciones: [{
      evento_id: "string",
      tipo: "hospedador|visitante",
      estado: "postulado|verificado|asignado|rechazado",
      fecha_postulacion: "timestamp",
      fecha_actualizacion: "timestamp"
    }],
    asignaciones_actuales: [{
      evento_id: "string",
      tipo: "hospedador|visitante",
      asignado_con: "user_id",
      fecha_asignacion: "timestamp"
    }],
    penalizaciones_recientes: [{
      tipo: "string",
      puntos_restados: "number",
      fecha: "timestamp",
      evento_id: "string"
    }],
    mensajes_admin: [{
      mensaje: "string",
      fecha: "timestamp",
      leido: "boolean",
      tipo: "info|advertencia|penalizacion|recordatorio"
    }]
  },
  
  // SISTEMA DE EDITORES
  eventos_asignados: ["evento_id1", "evento_id2"], // Solo para editores
  asignado_por: "admin_user_id",
  fecha_asignacion: "timestamp",
  createdAt: "timestamp"
}
```

### ğŸ—‚ï¸ ColecciÃ³n: eventos (ACTUALIZADA)
```javascript
{
  id: "evento_id",
  titulo: "string",
  descripcion: "string",
  lugar: "string",
  ciudad: "string",
  direccion_completa: "string",
  coordenadas_gps: "string",
  fecha_inicio: "timestamp",
  fecha_fin: "timestamp",
  imagenURL: "string",
  estado: "activo|inactivo",
  creado_por: "user_id",
  
  // SISTEMA DE EDITORES
  editores_asignados: ["editor_id1", "editor_id2"],
  region: "string",
  
  // ESTADÃSTICAS CON PENALIZACIONES
  estadisticas: {
    anfitriones: "number",
    visitantes: "number",
    asistentes: "number",
    emparejamientos: "number",
    verificaciones_completadas: "number",
    cancelaciones_ultimo_momento: "number",
    penalizaciones_aplicadas: "number"
  },
  
  // CONFIGURACIÃ“N DE RECORDATORIOS
  configuracion_recordatorios: {
    dias_limite_verificacion: "number (default: 3)",
    frecuencia_recordatorios: "24h|48h|72h",
    maximo_intentos_contacto: "number (default: 5)",
    recordatorios_automaticos: "boolean (default: true)"
  },
  
  // ALOJAMIENTOS CERCANOS
  hoteles: [{
    nombre: "string",
    direccion: "string",
    telefono: "string",
    precio_aproximado: "string",
    distancia_evento: "string",
    notas: "string"
  }],
  
  cocheras: [{
    nombre: "string",
    direccion: "string",
    telefono: "string",
    precio_por_dia: "string",
    capacidad: "number",
    distancia_evento: "string",
    notas: "string"
  }],
  
  // SISTEMA DE CONTINGENCIA
  contingencia: {
    anfitriones_backup: ["user_id1", "user_id2"],
    contactos_emergencia: [{
      nombre: "string",
      telefono: "string",
      relacion: "string",
      disponibilidad: "string"
    }],
    protocolo_cancelacion: "string",
    hoteles_emergencia: ["hotel_id1", "hotel_id2"],
    penalizacion_cancelacion_activa: "boolean (default: true)",
    horas_limite_cancelacion: "number (default: 48)"
  }
}
```

### ğŸ—‚ï¸ ColecciÃ³n: postulaciones (ACTUALIZADA CON CANCELACIONES)
```javascript
{
  id: "postulacion_id",
  evento_id: "string",
  usuario_id: "string",
  tipo: "hospedador|visitante",
  
  // ESTADOS DETALLADOS
  estado: "postulado|verificado|asignado|rechazado|cancelado",
  fecha_postulacion: "timestamp",
  fecha_verificacion: "timestamp",
  fecha_asignacion: "timestamp",
  
  // VERIFICACIÃ“N MANUAL
  verificacion_admin: {
    verificado_por: "admin_user_id",
    fecha_verificacion: "timestamp",
    metodo_verificacion: "whatsapp|llamada|presencial",
    notas_verificacion: "string",
    documentos_revisados: ["string"],
    aprobado: "boolean",
    recordatorios_enviados: "number"
  },
  
  // DATOS HOSPEDADOR
  datos_hospedador: {
    numero_habitaciones: "number",
    numero_camas: "number",
    personas_puede_hospedar: "number",
    tiene_cochera: "boolean",
    servicios_adicionales: ["desayuno", "transporte", "etc"],
    reglas_casa: "string",
    ubicacion_detalle: "string"
  },
  
  // DATOS VISITANTE
  datos_visitante: {
    numero_personas: "number",
    habitaciones_solicitadas: "number",
    tiene_vehiculo: "boolean",
    necesidades_especiales: "string",
    preferencias: "string",
    referencias: "string"
  },
  
  // ASIGNACIÃ“N MANUAL
  asignacion: {
    asignado_con: "user_id",
    asignado_por: "admin_user_id",
    fecha_asignacion: "timestamp",
    notas_asignacion: "string",
    es_asignacion_backup: "boolean"
  },
  
  // NUEVO: SISTEMA DE CANCELACIONES CON PENALIZACIONES
  cancelacion: {
    cancelado: "boolean",
    fecha_cancelacion: "timestamp",
    motivo: "string",
    cancelado_por: "user_id",
    horas_antes_evento: "number",
    penalizacion_aplicada: "boolean",
    puntos_penalizacion: "number",
    backup_asignado: "user_id",
    observaciones_admin: "string"
  }
}
```

### ğŸ—‚ï¸ ColecciÃ³n: emparejamientos (ACTUALIZADA)
```javascript
{
  id: "emparejamiento_id",
  evento_id: "string",
  anfitrion_id: "string",
  visitante_id: "string",
  
  // PROCESO MANUAL
  sugerido_por_algoritmo: "boolean",
  confirmado_por_admin: "admin_user_id",
  fecha_sugerencia: "timestamp",
  fecha_confirmacion: "timestamp",
  estado: "sugerido|confirmado|cancelado|penalizado",
  
  // COMPATIBILIDAD
  compatibilidad_score: "number",
  criterios_compatibilidad: {
    ubicacion: "number",
    capacidad: "number",
    vehiculo: "boolean",
    necesidades_especiales: "boolean"
  },
  
  // INFORMACIÃ“N DEL EMPAREJAMIENTO
  detalles: {
    habitaciones_asignadas: "number",
    camas_asignadas: "number",
    cochera_asignada: "boolean",
    servicios_incluidos: ["string"],
    reglas_especiales: "string"
  },
  
  // BACKUP Y CANCELACIONES
  es_asignacion_backup: "boolean",
  emparejamiento_original: "emparejamiento_id",
  cancelaciones_historicas: [{
    fecha: "timestamp",
    motivo: "string",
    usuario_cancelador: "user_id",
    penalizacion_aplicada: "boolean"
  }]
}
```

### ğŸ—‚ï¸ ColecciÃ³n: valoraciones_cristianas (ACTUALIZADA)
```javascript
{
  id: "valoracion_id",
  evento_id: "string",
  valorador_id: "string",
  valorado_id: "string",
  tipo_relacion: "anfitrion_a_visitante|visitante_a_anfitrion",
  
  // CRITERIOS CRISTIANOS ESPECÃFICOS
  criterios: {
    amabilidad: "number (1-5)",
    hospitalidad: "number (1-5)",
    respeto: "number (1-5)",
    caracter_cristiano: "number (1-5)",
    servicio_desinteresado: "number (1-5)",
    paciencia: "number (1-5)",
    generosidad: "number (1-5)"
  },
  
  // COMENTARIOS
  comentario_positivo: "string",
  areas_mejora: "string",
  recomendaria: "boolean",
  
  // ACLARACIÃ“N IMPORTANTE
  aclaracion: "Esta valoraciÃ³n se basa en el comportamiento cristiano y el trato recibido, NO en la calidad material del alojamiento o lujos ofrecidos",
  
  // NUEVA: VERIFICACIÃ“N DE PENALIZACIONES
  usuario_penalizado: "boolean",
  penalizaciones_durante_evento: [{
    tipo: "string",
    puntos_restados: "number",
    fecha: "timestamp"
  }],
  
  fecha_valoracion: "timestamp",
  verificado_por_admin: "boolean"
}
```

### ğŸ—‚ï¸ ColecciÃ³n: recordatorios_sistema (NUEVA)
```javascript
{
  id: "recordatorio_id",
  usuario_id: "string",
  evento_id: "string",
  tipo: "verificacion_pendiente|cancelacion_proximidad|emparejamiento_confirmado",
  
  // CONFIGURACIÃ“N DEL RECORDATORIO
  frecuencia: "24h|48h|72h",
  maximo_intentos: "number",
  intentos_realizados: "number",
  
  // FECHAS
  fecha_creacion: "timestamp",
  proxima_ejecucion: "timestamp",
  fecha_ultimo_envio: "timestamp",
  fecha_completado: "timestamp",
  
  // CONTENIDO
  mensaje: "string",
  prioridad: "baja|media|alta",
  
  // ESTADO
  estado: "activo|completado|cancelado|pausado",
  completado: "boolean",
  
  // METADATA
  creado_por: "sistema|admin_user_id",
  observaciones: "string"
}
```

### ğŸ—‚ï¸ ColecciÃ³n: observaciones_eventos (ACTUALIZADA)
```javascript
{
  id: "observacion_id",
  evento_id: "string",
  admin_id: "string",
  fecha: "timestamp",
  
  // TIPOS DE OBSERVACIÃ“N
  tipo: "incidente|mejora|observacion_general|problema_tecnico|sugerencia|penalizacion|cancelacion",
  gravedad: "baja|media|alta|critica",
  
  // CONTENIDO
  titulo: "string",
  descripcion: "string",
  usuarios_involucrados: ["user_id"],
  
  // NUEVA: INFORMACIÃ“N DE PENALIZACIONES
  penalizaciones_relacionadas: [{
    usuario_id: "string",
    tipo_penalizacion: "string",
    puntos_restados: "number",
    fecha_aplicacion: "timestamp"
  }],
  
  // SEGUIMIENTO
  estado: "abierto|en_revision|resuelto|cerrado",
  acciones_tomadas: "string",
  responsable_seguimiento: "admin_user_id",
  fecha_resolucion: "timestamp",
  
  // MEJORAS PARA LA APP
  impacto_futuro: "string",
  cambios_sugeridos: "string"
}
```

### ğŸ—‚ï¸ ColecciÃ³n: verificaciones_manuales (ACTUALIZADA)
```javascript
{
  id: "verificacion_id",
  usuario_id: "string",
  admin_verificador: "string",
  fecha_inicio: "timestamp",
  fecha_completada: "timestamp",
  
  // PROCESO DE VERIFICACIÃ“N
  metodo: "whatsapp|llamada|presencial|combinado",
  contacto_usado: "string",
  documentos_solicitados: ["cedula", "referencias", "carta_pastor"],
  documentos_recibidos: ["string"],
  
  // NUEVA: SISTEMA DE RECORDATORIOS
  recordatorios: {
    total_enviados: "number",
    fechas_recordatorios: ["timestamp"],
    respuesta_usuario: "boolean",
    fecha_respuesta: "timestamp",
    metodo_respuesta: "whatsapp|llamada|presencial"
  },
  
  // VERIFICACIÃ“N DETALLADA
  verificaciones: {
    identidad: "boolean",
    telefono: "boolean",
    direccion: "boolean",
    referencias_cristianas: "boolean",
    antecedentes: "boolean"
  },
  
  // RESULTADO
  resultado: "aprobado|rechazado|pendiente_documentos",
  notas_verificador: "string",
  observaciones: "string",
  
  // SEGUIMIENTO
  requiere_seguimiento: "boolean",
  fecha_siguiente_revision: "timestamp",
  recordatorio_automatico: "boolean"
}
```

---

## ğŸ”„ FLUJOS DE TRABAJO ACTUALIZADOS

### 1. ğŸ“‹ FLUJO DE VERIFICACIÃ“N MANUAL CON RECORDATORIOS
```
Usuario se registra â†’ Estado: "pendiente_verificacion"
     â†“
Sistema crea recordatorio automÃ¡tico (cada 24h despuÃ©s de 3 dÃ­as)
     â†“
Admin/Editor revisa solicitud â†’ Contacta por WhatsApp/llamada
     â†“
Si no responde â†’ Sistema envÃ­a recordatorio â†’ Aumenta contador intentos
     â†“
VerificaciÃ³n exitosa â†’ Estado: "verificado" + 1 estrella
     â†“
Usuario habilitado para postular a eventos
```

### 2. ğŸ¤ FLUJO DE EMPAREJAMIENTO MANUAL
```
MÃºltiples usuarios postulan (anfitriones + visitantes)
     â†“
Algoritmo genera vista previa con compatibilidad
     â†“
Admin revisa sugerencias â†’ Decide manualmente
     â†“
Admin confirma emparejamiento â†’ Notifica a usuarios
     â†“
Sistema actualiza estados â†’ Visible en "Mi Perfil"
```

### 3. ğŸš« FLUJO DE CANCELACIÃ“N CON PENALIZACIONES
```
Usuario cancela postulaciÃ³n â†’ Sistema calcula horas restantes
     â†“
Si < 48h antes del evento â†’ Aplica penalizaciÃ³n -2 estrellas
     â†“
Sistema busca backup â†’ Reasigna si existe
     â†“
Notifica cambios â†’ Actualiza valoraciones
     â†“
Admin revisa â†’ Puede apelar penalizaciÃ³n si hay justificaciÃ³n
```

### 4. ğŸ”„ FLUJO DE CONTINGENCIA
```
AnfitriÃ³n cancela â†’ Sistema detecta
     â†“
Verifica tiempo restante â†’ Aplica penalizaciÃ³n si corresponde
     â†“
Admin busca en lista de backup
     â†“
Reasigna visitante â†’ Notifica cambio
     â†“
Si no hay backup â†’ Deriva a hoteles de emergencia
```

### 5. â­ FLUJO DE VALORACIÃ“N CRISTIANA
```
Evento termina â†’ Habilita valoraciÃ³n mutua
     â†“
AnfitriÃ³n valora visitante + Visitante valora anfitriÃ³n
     â†“
Sistema calcula promedio â†’ Considera penalizaciones
     â†“
Admin revisa valoraciones â†’ Modera si es necesario
```

### 6. ğŸ”” FLUJO DE RECORDATORIOS AUTOMÃTICOS
```
Sistema ejecuta cada 24h â†’ Busca verificaciones pendientes > 3 dÃ­as
     â†“
Verifica Ãºltimo recordatorio â†’ Si > 24h envÃ­a nuevo recordatorio
     â†“
Actualiza contador intentos â†’ Notifica en perfil usuario
     â†“
Si > 5 intentos â†’ Marca como "requiere_seguimiento_manual"
```

---

## ğŸ›¡ï¸ SISTEMA DE SEGURIDAD ACTUALIZADO

### 1. ğŸ” Middleware de VerificaciÃ³n
```javascript
// Verificar estado de verificaciÃ³n antes de postular
function checkVerificationStatus(req, res, next) {
  const userId = req.user.uid;
  
  getUserVerificationStatus(userId)
    .then(status => {
      if (status === 'verificado') {
        next();
      } else {
        res.status(403).json({ 
          error: 'Debe completar la verificaciÃ³n antes de postular',
          redirect: '/verification/verification-process.html'
        });
      }
    });
}
```

### 2. ğŸš« Middleware de Penalizaciones
```javascript
// Verificar penalizaciones antes de aplicar cancelaciÃ³n
function checkCancellationPenalty(req, res, next) {
  const userId = req.user.uid;
  const eventoId = req.params.eventoId;
  
  calculateCancellationPenalty(userId, eventoId)
    .then(penalty => {
      if (penalty.shouldApply) {
        applyPenalty(userId, penalty.points, penalty.reason);
        logPenaltyAction(userId, eventoId, penalty);
      }
      next();
    });
}
```

### 3. ğŸ”’ Control de Emparejamiento Manual
```javascript
// Solo admin puede confirmar emparejamientos
function checkMatchingPermission(req, res, next) {
  const userId = req.user.uid;
  const eventoId = req.params.eventoId;
  
  if (req.user.rol === 'administrador') {
    next();
  } else if (req.user.rol === 'editor') {
    verificarEventoAsignado(userId, eventoId)
      .then(hasPermission => {
        if (hasPermission) {
          next();
        } else {
          res.status(403).json({ error: 'No tienes permisos para este evento' });
        }
      });
  } else {
    res.status(403).json({ error: 'Solo admin/editor pueden confirmar emparejamientos' });
  }
}
```

### 4. ğŸ”” Control de Recordatorios
```javascript
// Solo admin/editor pueden gestionar recordatorios
function checkReminderPermission(req, res, next) {
  const userId = req.user.uid;
  const userRole = req.user.rol;
  
  if (userRole === 'administrador') {
    next();
  } else if (userRole === 'editor') {
    // Editor solo puede ver recordatorios de sus eventos asignados
    checkAssignedEvents(userId, req.params.eventoId)
      .then(hasAccess => {
        if (hasAccess) {
          next();
        } else {
          res.status(403).json({ error: 'No tienes acceso a este evento' });
        }
      });
  } else {
    res.status(403).json({ error: 'Sin permisos para gestionar recordatorios' });
  }
}
```

### 5. ğŸ” Reglas de Firestore Actualizadas
```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // Valoraciones: solo participantes del evento pueden valorar
    match /valoraciones_cristianas/{valoracionId} {
      allow create: if request.auth != null && 
        exists(/databases/$(database)/documents/emparejamientos/$(getEmparejamientoId())) &&
        (request.resource.data.valorador_id == request.auth.uid);